# RabbitMQ production configuration

# Networking
listeners.tcp.default = 5672
num_acceptors.tcp = 10
handshake_timeout = 10000
log.connection.level = info

# Memory and disk
vm_memory_high_watermark.relative = 0.8
disk_free_limit.relative = 1.0
vm_memory_calculation_strategy = rss

# Clustering
cluster_formation.peer_discovery_backend = rabbit_peer_discovery_classic_config
cluster_formation.randomized_startup_delay_range.min = 0
cluster_formation.randomized_startup_delay_range.max = 2

# Queue settings
queue_master_locator = min-masters
queue_index_embed_msgs_below = 4096

# Management plugin
management.tcp.port = 15672
management.tcp.ip = 0.0.0.0
management.http_log_dir = /var/log/rabbitmq
management.rates_mode = basic

# Logging
log.file.level = info
log.console = true
log.console.level = info
log.file = /var/log/rabbitmq/rabbit.log
log.file.rotation.date = $D0
log.file.rotation.size = 10485760

# SSL (if needed)
# ssl_options.cacertfile = /etc/rabbitmq/ssl/ca_certificate.pem
# ssl_options.certfile = /etc/rabbitmq/ssl/server_certificate.pem
# ssl_options.keyfile = /etc/rabbitmq/ssl/server_key.pem
# ssl_options.verify = verify_peer
# ssl_options.fail_if_no_peer_cert = true

# Performance tuning
channel_max = 2047
connection_max = 1000
heartbeat = 60
frame_max = 131072
collect_statistics = coarse
collect_statistics_interval = 5000

# Policies
policy.ha-mode = all
policy.ha-sync-mode = automatic
policy.ha-sync-batch-size = 1

# Federation (if needed)
# federation_upstream_set.all.policy = federate-me

# Shovel (if needed)
# shovel.src-uri = amqp://guest:guest@source-broker:5672
# shovel.dest-uri = amqp://guest:guest@destination-broker:5672